knitr::opts_chunk$set(echo = TRUE, message=F, warning=F)
library( dplyr )
library( pander )
URL <- "https://raw.githubusercontent.com/DS4PS/Data-Science-Class/master/DATA/syr_parcels.csv"
dat <- read.csv( URL, stringsAsFactors=FALSE )
dat %>%
filter( land_use == "Single Family" ) %>%
dplyr::group_by( neighborhood ) %>%
dplyr::summarize( ave.late.bill = mean( amtdelinqu, na.rm=T ) )
dat %>%
filter( land_use == "Single Family" ) %>%
plyr::group_by( neighborhood ) %>%
summarize( ave.late.bill = mean( amtdelinqu, na.rm=T ) ) %>%
arrange( desc( ave.late.bill ) )
dat %>%
filter( land_use == "Single Family" ) %>%
group_by( neighborhood ) %>%
summarize( ave.late.bill = mean( amtdelinqu, na.rm=T ) ) %>%
arrange( desc( ave.late.bill ) )
dat %>%
count( neighborhood, land_use ) %>%
filter( land_use == "Vacant Land" ) %>%
select( neighborhood, n ) %>%
arrange( desc(n) )
dat %>%
group_by( neighborhood ) %>%
top_n( 1, amtdelinqu ) %>%
select( neighborhood, owner, land_use, vacantbuil, taxyrsdeli, amtdelinqu, totint ) %>%
arrange( desc( amtdelinqu ) ) %>%
pander()
dat %>%
group_by( neighborhood ) %>%
top_n( 1, amtdelinqu ) %>%
ungroup() %>%
select( neighborhood, owner, land_use, vacantbuil, taxyrsdeli, amtdelinqu, totint ) %>%
arrange( desc( amtdelinqu ) ) %>%
pander()
help( top_n )
dat %>%
group_by( neighborhood ) %>%
top_n( 1, amtdelinqu ) %>%
ungroup() %>%
select( neighborhood, owner, land_use, vacantbuil, taxyrsdeli, amtdelinqu, totint ) %>%
arrange( desc( amtdelinqu ) ) %>%
head( 25 ) %>%
pander()
table( age_range )
table( dat$age_range )
unique( dat$age_range )
unique( dat$age_range ) %>% sort()
decades <- c("1-10","11-20","21-30","31-40","41-50","51-60","61-70",
"71-80","81-90","91-100","101-110","111-120","121-130",
"131-140","141-150","151-160","161-170","171-180",
"181-190","191-200","201-210","211-220","221-230")
dat$age_range <- factor( dat$age_range, levels=decades )
table( dat$age_range )
dat %>%
filter( land_use == "Single Family" ) %>%
group_by( neighborhood ) %>%
summarize( ave.late.bill = round( mean( amtdelinqu, na.rm=T ), 0 ) ) %>%
arrange( desc( ave.late.bill ) )
knitr::opts_chunk$set(echo = TRUE, message=F, warning=F, fig.align='center', fig.width=9 )
library( dplyr )
library( pander )
library( ggmap )
library( ggplot2 )
library( leaflet )
library( viridis )
URL <- "https://github.com/DS4PS/Data-Science-Class/blob/master/DATA/TempeTrafficAccidents.rds?raw=true"
dat <- readRDS(gzcon(url( URL )))
head( dat )
dat <-
dat %>%
# filter( Totalinjuries > 0 | Totalfatalities > 0 ) %>%
mutate( tot.injuries.fatalities = Totalinjuries + Totalfatalities,
point.size = tot.injuries.fatalities)
dat$Collisionmanner <- recode( dat$Collisionmanner,
"ANGLE (Front To Side)(Other Than Left Turn)"="Angle" )
dat$Collisionmanner <- recode( dat$Collisionmanner, "Sideswipe Same Direction"="Lane Change" )
drop.these <- c("Unknown","10","Rear To Side","Rear To Rear","Sideswipe Opposite Direction","Other")
dat <- filter( dat, ! ( Collisionmanner %in% drop.these ) )
dat$Collisionmanner <- factor( dat$Collisionmanner )
count( dat, Collisionmanner ) %>% arrange(n) %>% pander()
d3 <-
dat %>%
filter( !is.na(week), !is.na(Collisionmanner) ) %>%
count( week, Collisionmanner )
date.vec <- strptime( dat$DateTime, format="%m/%d/%y %H:%M" )
head( date.vec )
dat$hour   <- format( date.vec, format="%H" )
dat$month  <- format( date.vec, format="%b" )
dat$day    <- format( date.vec, format="%a" )
dat$day365 <- format( date.vec, format="%j" )
dat$week   <- format( date.vec, format="%V" )
qmplot( Longitude, Latitude, data=dat, geom = "blank",
zoom = 13, maptype = "toner-background", darken = .1 ) +
stat_density_2d( aes(fill = ..level..), geom = "polygon", alpha=0.3, color = NA) +
scale_fill_viridis(  ) +
facet_wrap( ~ hour, ncol=6, nrow=4)
qmplot( Longitude, Latitude, data=dat, geom = "blank",
zoom = 13, maptype = "toner-background", darken = .7 ) +
stat_density_2d( aes(fill = ..level..), geom = "polygon", alpha=0.2, color = NA) +
scale_fill_gradient2( low="white", mid="yellow", high="red",  midpoint=100 ) +
facet_wrap( ~ hour, ncol=6, nrow=4 )
